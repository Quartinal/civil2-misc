var e=class r{inner;constructor(t){this.inner=t}static fromDictionary(t){let{StrShuffler:n}=globalThis.__rammerheadWasm;return new r(n.fromDictionary(t))}static generate(t){let{StrShuffler:n}=globalThis.__rammerheadWasm,s=t??BigInt(Date.now());return new r(n.generate(s))}get dictionary(){return this.inner.dictionary}shuffle(t){return this.inner.shuffle(t)}unshuffle(t){return this.inner.unshuffle(t)}free(){this.inner.free()}unwrap(){return this.inner}};function f(r,t,n,s){let{buildProxyHref:i}=globalThis.__rammerheadWasm;return i(r,t,n.unwrap(),s)}var c="session-string";async function a(r){let t=await fetch(r);if(!t.ok)throw new Error(`http ${t.status} from ${r}`);return t.text()}async function h(r,t){return await a(`${r}/sessionexists?id=${encodeURIComponent(t)}`)==="exists"}async function m(r){return a(`${r}/newsession`)}async function l(r,t){let n=await a(`${r}/api/shuffleDict?id=${encodeURIComponent(t)}`);return JSON.parse(n)}async function g(r){let t=localStorage.getItem(c);if(t&&await h(r,t))return t;let n=await m(r);return localStorage.setItem(c,n),n}async function w(r,t,n){let s=await g(t),i=await l(t,s),o=e.fromDictionary(i),u=f(r,s,o,n);return o.free(),u}export{w as encode};
//# sourceMappingURL=session.js.map
